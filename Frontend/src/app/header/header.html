<header class="app-header">
  <nav>
    <div class="menu-icon">
      <span class="fa-solid fa-bars"></span>
    </div>
    
    <a class="logo" routerLink="/home">
  <img src="/assets/LOGO_TECH3.png" alt="Logo Real Tech" class="realtech-logo" /> Real Tech
    </a>
    
    <div class="nav-items">
      <li><a href="/home">Home</a></li>
      <li class="signin" *ngIf="!user" (click)="$event.stopPropagation()">
        <a class="nav-link" href="javascript:void(0)"
           (click)="toggleSignInMenu($event)"
           aria-haspopup="true"
           [attr.aria-expanded]="showSignInMenu">
          Sign in
        </a>
        <div class="signin-menu" [class.open]="showSignInMenu" (click)="$event.stopPropagation()">
          <a routerLink="/login">Accedi</a>
          <a routerLink="/registrazione">Registrati</a> 
        </div>
      </li>

      <li *ngIf="user"><a routerLink="/profilo">Profilo</a></li>
      <li *ngIf="user"><a href="#" (click)="logout()">Logout</a></li>
      <li><a routerLink="/about">About</a></li>
      <li><a routerLink="/catalogo" (click)="pulisciParametriCatalogo()">Catalogo</a></li>
      <li><a routerLink="/carrello">Carrello</a></li>
      <li *ngIf="user && (user.ruolo === 'admin' || user.ruolo === 'owner')"><a routerLink="/admin">Area Admin</a></li>
    </div>

    <!-- Icona di ricerca in alto a destra -->
    <div class="search-icon-trigger" (click)="toggleSearchOverlay()" title="Cerca prodotti">
      <i class="fa-solid fa-search"></i>
        <span>üîç</span>
    </div>
  </nav>
</header>

<!-- Overlay full-screen per la ricerca -->
<div class="search-overlay-fullscreen" *ngIf="showSearchOverlay" (click)="closeSearchOverlay()">
  <div class="search-overlay-content" (click)="$event.stopPropagation()">
    <div class="search-overlay-header">
      <h2>Cerca prodotti</h2>
      <button class="close-search-btn" (click)="closeSearchOverlay()">
        <i class="fa-solid fa-times"></i>
      </button>
    </div>
    
    <div class="search-input-container">
      <form (ngSubmit)="searchProducts()">
        <input 
          #searchInput
          type="search" 
          class="search-input-expanded" 
          placeholder="Cosa stai cercando?" 
          [(ngModel)]="searchQuery"
          name="searchQuery"
          (input)="onSearchInput($event)"
          (keypress)="onSearchKeyPress($event)"
          autocomplete="off"
          required>
        <button type="submit" class="search-submit-btn">
          <i class="fa-solid fa-search"></i>
          Cerca
        </button>
      </form>
    </div>

    <!-- Suggerimenti in layout grid -->
    <div class="suggestions-section" *ngIf="showSuggestions">
      <h3>Suggerimenti</h3>
      <div class="suggestions-grid-expanded">
        <div 
          class="suggestion-card-expanded" 
          *ngFor="let suggestion of searchSuggestions"
          (click)="selectSuggestion(suggestion)">
          <img 
            [src]="suggestion.immagine_url" 
            [alt]="suggestion.nome"
            class="suggestion-image-expanded"
            loading="lazy"
            onerror="this.src='http://localhost:8080/api/images/prodotti/default.jpg'">
          <div class="suggestion-info-expanded">
            <h4 class="suggestion-name-expanded">{{ suggestion.nome }}</h4>
            <p class="suggestion-brand-expanded">{{ suggestion.marchio }}</p>
            <div class="suggestion-price-expanded">‚Ç¨{{ suggestion.prezzo_scontato != null ? suggestion.prezzo_scontato : suggestion.prezzo }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
